<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ticket Description Helper - Necessary Fields</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f7f9;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 600px;
      margin: 48px auto;
      background-color: #fff;
      padding: 24px 30px;
      box-shadow: 0 0 12px rgba(0, 0, 0, 0.12);
      border-radius: 8px;
    }
    h1 {
      text-align: center;
      margin-bottom: 24px;
      color: #222;
    }
    label {
      display: block;
      margin: 14px 0 6px;
      color: #444;
      font-weight: bold;
    }
    select,
    textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 6px;
      box-sizing: border-box;
      font-size: 15px;
      resize: vertical;
    }
    textarea {
      min-height: 80px;
    }
    button {
      margin-top: 20px;
      padding: 12px;
      width: 100%;
      font-size: 16px;
      font-weight: bold;
      background-color: #0066cc;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.25s ease;
    }
    button:hover {
      background-color: #004999;
    }
    .output {
      margin-top: 30px;
      padding: 18px 24px;
      border: 1px solid #aaa;
      border-radius: 7px;
      background-color: #fefefe;
      color: #222;
      min-height: 120px;
      white-space: pre-wrap;
      font-size: 15px;
      line-height: 1.4;
    }
    .output strong {
      display: block;
      margin-bottom: 8px;
      color: #004999;
    }
    ul {
      padding-left: 18px;
    }
    li {
      margin-bottom: 6px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Ticket Description Helper Tool</h1>

    <label for="application-select">Select Application:</label>
    <select id="application-select" aria-label="Select Application">
      <option value="">-- Select Application --</option>
      <option value="paoProd">Prepare Account Offering (PAO) Prod</option>
      <option value="atOnce">E-Commerce Order - At Once</option>
      <option value="futuresWeb">E-Commerce Order - Futures Web</option>
      <option value="manageApla">E-Commerce Manage - Order Status (APLA/EMEA)</option>
      <option value="manageNa">E-Commerce Manage - Order Status (NA/GC)</option>
    </select>

    <label for="description-input">Enter Short Description:</label>
    <textarea id="description-input" placeholder="Type your ticket description here..." aria-label="Ticket Description"></textarea>

    <button id="suggest-btn">Suggest Necessary Fields</button>

    <div id="output" class="output" role="region" aria-live="polite"></div>
  </div>

  <script>
    // Full mandatory fields per app as baseline
    const baselineFields = {
      paoProd: [
        "Short Description",
        "User Email/Username",
        "Sold-To Code",
        "Season",
        "Country/Region",
        "Product Codes",
        "Business Justification",
        "Error Message (if any)",
        "Screenshot/Attachment (optional but recommended)"
      ],
      atOnce: [
        "Short Description",
        "User Email/Username",
        "Account/Sold-To Number",
        "Product/Style Number(s)",
        "Order Number",
        "Description (details & steps to reproduce)",
        "Season (if applicable)",
        "Error Message",
        "Attachment/Screenshot",
        "Cart ID or Coupon Code (if applicable)",
        "Date/Time of Issue"
      ],
      futuresWeb: [
        "Short Description",
        "Nike.net User Email/Username",
        "Sold-To/Account Number",
        "Order Number",
        "Product/Style Numbers",
        "Season",
        "PO Number (if relevant)",
        "Description (details & steps to reproduce)",
        "Error Messages/Logs (if applicable)",
        "Date/Time of Issue",
        "Additional Context Info (e.g. cart id, replication steps)"
      ],
      manageApla: [
        "Short Description",
        "User Email/Username",
        "Sold-To/Account Number",
        "Season",
        "Product Codes/SKUs",
        "Order Number/PO Number (if related)",
        "Description/Supporting Details (steps, expected vs actual)",
        "Invoice/Billing Info (if applicable)",
        "Country/Region",
        "Date/Time of Issue or related transaction",
        "Attachments/Screenshots (optional but helpful)"
      ],
      manageNa: [
        "Short Description",
        "Account Number/Sold-To Code",
        "Order Number(s)",
        "User Email/Username",
        "Product Codes/Style Numbers",
        "Description Details (problem description, steps to reproduce)",
        "Date/Time of Affected Order/Transaction",
        "Issue Type (e.g., negative units showing, missing orders)",
        "Error Messages or Screenshot Attachments (if relevant)",
        "Season/CRD (if related to orders or product availability)",
        "Sold To and Ship To Codes",
        "Contract Number or Period (if related to contract issues)"
      ]
    };

    // Keywords to match description content to specific fields (per app); simplified example
    const appFieldKeywords = {
      paoProd: {
        "sold-to": ["Sold-To Code"],
        "season": ["Season"],
        "country": ["Country/Region"],
        "product": ["Product Codes"],
        "error": ["Error Message (if any)"],
        "business": ["Business Justification"],
        "screenshot": ["Screenshot/Attachment (optional but recommended)"],
        "email": ["User Email/Username"]
      },
      atOnce: {
        "account": ["Account/Sold-To Number"],
        "product": ["Product/Style Number(s)"],
        "order": ["Order Number"],
        "season": ["Season (if applicable)"],
        "error": ["Error Message"],
        "cart": ["Cart ID or Coupon Code (if applicable)"],
        "attachment": ["Attachment/Screenshot"],
        "date": ["Date/Time of Issue"],
        "email": ["User Email/Username"]
      },
      futuresWeb: {
        "order": ["Order Number"],
        "product": ["Product/Style Numbers"],
        "season": ["Season"],
        "po": ["PO Number (if relevant)"],
        "error": ["Error Messages/Logs (if applicable)"],
        "cart": ["Additional Context Info (e.g. cart id, replication steps)"],
        "email": ["Nike.net User Email/Username"],
        "date": ["Date/Time of Issue"]
      },
      manageApla: {
        "sold-to": ["Sold-To/Account Number"],
        "season": ["Season"],
        "product": ["Product Codes/SKUs"],
        "order": ["Order Number/PO Number (if related)"],
        "country": ["Country/Region"],
        "invoice": ["Invoice/Billing Info (if applicable)"],
        "attachment": ["Attachments/Screenshots (optional but helpful)"],
        "email": ["User Email/Username"],
        "date": ["Date/Time of Issue or related transaction"]
      },
      manageNa: {
        "account": ["Account Number/Sold-To Code"],
        "order": ["Order Number(s)"],
        "product": ["Product Codes/Style Numbers"],
        "email": ["User Email/Username"],
        "issue": ["Issue Type (e.g., negative units showing, missing orders)"],
        "error": ["Error Messages or Screenshot Attachments (if relevant)"],
        "season": ["Season/CRD (if related to orders or product availability)"],
        "contract": ["Contract Number or Period (if related to contract issues)"]
      }
    };

    function getNecessaryFields(appKey, description) {
      const descLower = description.toLowerCase();

      if (!descLower) return [];

      const keywordsMap = appFieldKeywords[appKey] || {};
      const necessaryFieldsSet = new Set();

      // Always include "Short Description"
      necessaryFieldsSet.add("Short Description");

      // Simple keyword matching in description to include fields
      for (const [keyword, fields] of Object.entries(keywordsMap)) {
        if (descLower.includes(keyword)) {
          fields.forEach(f => necessaryFieldsSet.add(f));
        }
      }

      // If only Short Description found, add minimal base fields to help
      if (necessaryFieldsSet.size === 1) {
        // Add couple of base mandatory fields from baseline (excluding Short Description)
        const baseFields = baselineFields[appKey] || [];
        baseFields.forEach(field => {
          if (field !== "Short Description") necessaryFieldsSet.add(field);
        });
      }

      return Array.from(necessaryFieldsSet);
    }

    const appNames = {
      paoProd: "Prepare Account Offering (PAO) Prod",
      atOnce: "E-Commerce Order - At Once",
      futuresWeb: "E-Commerce Order - Futures Web",
      manageApla: "E-Commerce Manage - Order Status (APLA/EMEA)",
      manageNa: "E-Commerce Manage - Order Status (NA/GC)"
    };

    document.getElementById("suggest-btn").addEventListener("click", () => {
      const appSelect = document.getElementById("application-select");
      const descInput = document.getElementById("description-input");
      const output = document.getElementById("output");

      const appKey = appSelect.value;
      const description = descInput.value.trim();

      if (!appKey) {
        output.innerHTML = "<span style='color:#c00'>Please select an application first.</span>";
        return;
      }
      if (!description) {
        output.innerHTML = "<span style='color:#c00'>Please enter a short description.</span>";
        return;
      }

      const necessaryFields = getNecessaryFields(appKey, description);

      output.innerHTML = `<strong>Necessary Fields for <span style="color:#008dc6;">${appNames[appKey]}</span> based on your description:</strong><ul>`
        + necessaryFields.map(field => `<li>${field}</li>`).join('') +
        `</ul>
        <div style="margin-top:12px; font-size: 13px; color: #228B22;">
          Please make sure to fill these fields completely before submitting your ticket for quicker resolution.
        </div>`;
    });
  </script>
</body>
</html>
